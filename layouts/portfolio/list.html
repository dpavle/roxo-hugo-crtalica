{{ define "main" }}

<script>
  document.addEventListener("DOMContentLoaded", async function () {
    const beholdUrl = "{{ .Site.Params.behold_url }}";
    const projectContainer = document.getElementById("project-container");

    try {
      const response = await fetch(beholdUrl);
      const data = await response.json();

      const projects = data.slice(0, 6);

      projects.forEach(item => {
        const mediaType = item.mediaType.toLowerCase();
        const mediaUrl = item.mediaUrl;
        const permalink = item.permalink;
        const caption = item.caption || "";

        const projectHTML = `
          <div class="col-lg-6 col-md-10 mx-auto">
            <div class="site-project-item">
              <a href="${permalink}" target="_blank" rel="noopener noreferrer">
                <div class="site-project-item-thumb">
                  <img class="${mediaType}" src="${mediaUrl}" alt="${caption}">
                </div>
                <div class="site-project-item-content">
                  <h4>${caption}</h4>
                </div>
              </a>
            </div>
          </div>
        `;

        projectContainer.innerHTML += projectHTML;
      });
    } catch (error) {
      console.error("Error fetching project data:", error);
      projectContainer.innerHTML = `<p>Gre≈°ka pri dobavljanju postova.</p>`;
    }
  });
</script>

<section class="site-project-header">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-8">
        <div class="site-project-header-content">
          <h1>
            {{ .Title | safeHTML }}
          </h1>
        </div>
      </div>
      <div class="col-lg-4">
        <a href="#project" class="site-project-header-action scroll-to">
          <img src="{{ "images/arrow-down.svg" | absURL }}" alt="arrow-down">
        </a>
      </div>
    </div>
  </div>
</section>

<section class="site-project" id="project">
  <div class="container">
    <!-- placeholder for JS rendered content -->
    <div id="project-container" class="row"></div>
  </div>
</section>

{{ partial "call-to-action.html" . }}

{{ end }}